<include file="Public:page_header_list" />
<body>
<link rel="stylesheet" href="./Application/Tpl/Home/Public/css/default.css?v=<{$Think.const.V}>">
<style>  
    html,body,div,span,table,tr,td,em,input,th{
        font-family: "微软雅黑 Bold","微软雅黑";
    }
    .col-md-11 ul li{
        font-family: "微软雅黑" !important;
    }
    .new-kehu .col-md-1 {width: 65px;}
    .new-kehu .col-md-1 span {
        color: #333333;display: inline-block;
        font-family: "微软雅黑 Bold","微软雅黑";
        font-size: 13px;font-style: normal;
        font-weight: 400;line-height: normal;
        margin: 10px 0;padding: 3px 0;
    }
    .link_blue{text-decoration:underline;color:#06c;}
    .menu-state .active{
        background: #1e7eb4 none repeat scroll 0 0;
        text-align: center;
        padding: 6px 15px;
    }
    .menu-state .active a {
        background: #1e7eb4 none repeat scroll 0 0;
        color: white;
    }
    .menu-state a {color: #282828;height:18px;display: inline-block;}
    .menu-state ul li {display:inline-block;padding: 6px 15px ;}
    .row .menu-state_span{
        padding-left: 5px;
        display: block;float: left;
        color: #546e7a;
        height:37px;line-height: 37px;
        width:68px;
    }
    .menu-state > ul > li:nth-child(1) {
        color: #ED2D65;cursor: pointer;
        white-space: nowrap;margin:2px 5px;
        padding: 6px 15px;
    }
    .row .menu-state_ul{
        display: block;float: left;
        width:85%;margin-top: 3px;
    }
    .menu-state{
        min-height:32px;width:100%;
        margin-top: 10px;
    }
    .row .menu-state_ul li{
        margin:2px 5px;border-radius: 15px;
    }
    input,select,button,.select-box{border-radius:5px;}
    .menu-state ul li b{font-size: 16px;color: black;cursor:inherit !important;}
    .btn-pink{
        background:#ed2d65;
        color:white;
    }
    .col-search{
        margin: 20px 0;
    }
    .select-box, .select-box.size-M{
        padding: 0px;
    }
    #form_search{
        height: 100%;
    }
    .btns{
        margin-top: 20px;
        width: 400px;

    }
    .btns button{
        width: 100px;
        height: 36px;
        margin-right: 30px;
        box-shadow: 0 0 2px 0 rgba(0,0,0,0.12), 0 2px 2px 0 rgba(0,0,0,0.24);
        transition: .5s all;
        font-size: 14px;
    }
    .search-num-wrap a:hover{
        text-decoration: none;
    }
    .btns button.btn-pink:hover{
        background: #228ECA;
    }
    .btns button.btn-clear:hover{
        background: #F8F8F8;
    }
    .btns button:active{
        box-shadow: none;
    }
    .btns button.btn-clear:active{
        background-color: #eceff1;
    }
    .btns button.btn-pink:active{
        background-color: #1e7eb4;
    }
    .btn-pink{
        background-color: #1e7eb4;
        color: #fff;
        border: none;
    }
    input, select, button, .select-box{
        border-radius: 4px;
    }
    .btn-clear{
        background-color: #eceff1;
        color:#1e7eb4 ;
        border: none;
    }
    .line{
        width: 100%;
        height: 10px;
        background-color: #eceff1;
        margin-top: 16px;
        margin-bottom: 20px;
    }
    .table-bg thead th{
        background-color: #546e7a;
        color: #fff;
        font-size: 14px;
        font-weight: 400;
        border-color:#546e7a; 
    }
    .table-bordered th, .table-bordered td{
        border-left: 1px solid #cadee7;
    }
    .table-border th, .table-border td{
        border-bottom: 1px solid #cadee7;
    }
    a.link_blue{
        display: inline-block;
        color: #fff;
        background-color: #1e7eb4;
        text-decoration: none;
        padding: 2px 10px;
        border-radius: 4px;
    }
    .col-search input{
        width: 180px;
    }
    .latest-login-time{
        margin-left: 100px;
    }
    .clearfix:before,.clearfix:after {
        content: "";
        display: block;
        clear: both;
  }
  .clearfix {
        zoom: 1;
  }
    @media only screen and (max-width: 1080px) {
        .col-search input{
            width: 120px !important;
        }
    }
    @media only screen and (max-width: 820px) {
        .col-search input{
            width: 120px !important;
        }
        .latest-login-time,.reg-time{
        margin-left: 0px !important;
        display: block  !important;
        }
        .latest-login-time{
            margin-top:20px;
        }
        .col-search{
            display: block !important;
            float: none;
        }
        .reg-time span,.latest-login-time span{
            width:84px;
            display: inline-block;
        }
      }
</style>
    <div>
        <div class="pos-r mr-20 ml-20" style="margin-left:30px;">
            <form action="" method="get" id="form_search">
            <input type="hidden" name="m" value="<{$Think.MODULE_NAME}>">
            <input type="hidden" name="a" value="<{$Think.ACTION_NAME}>">

            <div class="row clearfix" style="border-bottom:1px solid #dddddd;">
                <div class="col-lg-10 col-md-12 col-xs-12 menu-state ">
                    <ul>
                        <li class="">
                            <b><{$Think.lang.客户列表}></b>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="row clearfix">
                <div class="col-lg-10 col-md-12 col-xs-12 menu-state ">
                    <span class="menu-state_span show_title"><{$Think.lang.客户状态}>：</span>
                    <ul class="menu-state_ul">
                        <li class="<?php if(empty($filterArr['by_stat_cd'])){ ?>active<?php } ?>" >
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_stat_cd='); ?>"><{$Think.lang.全部}></a>
                        </li>
                        <foreach name="stat_cd_list" item="vo">
                        <?php $now_str = implode(',',ZFun::arrNormalUnique(ZFun::arrToIdsArr( array($filterArr['by_stat_cd'],$key) ))); ?>
                        <?php $now_exists = ZFun::arrNormalUnique(ZFun::arrToIdsArr( array($filterArr['by_stat_cd']) )); ?>
                        <li class="<?php if(in_array($key,$now_exists)){ ?>active<?php } ?>" >
                            <?php if(in_array($key,$now_exists)){ ?>
                                <?php $now_clean_arr = Mainfunc::arrRmByVal($now_exists,$key); ?>
                                <?php $now_clean_str = implode(',',$now_clean_arr); ?>
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_stat_cd='.$now_clean_str); ?>"><?php echo L($vo);?></a>
                            <?php }else{ ?>
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_stat_cd='.$now_str); ?>"><?php echo L($vo);?></a>
                            <?php } ?>
                        </li>
                        </foreach>
                    </ul>
                </div>
            </div>
            <input type="hidden" name="by_stat_cd" value="<?php echo $filterArr['by_stat_cd']; ?>" >

            <div class="row clearfix">
                <div class="col-lg-10 col-md-12 col-xs-12 menu-state ">
                    <span class="menu-state_span show_title"><{$Think.lang.所属平台}>：</span>
                    <ul class="menu-state_ul">
                        <li class="<?php if(empty($filterArr['by_plat_cd'])){ ?>active<?php } ?>" >
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_plat_cd='); ?>"><{$Think.lang.全部}></a>
                        </li>
                        <foreach name="plat_list" key="key" item="value">
                        <?php $now_str = implode(',',ZFun::arrNormalUnique(ZFun::arrToIdsArr( array($filterArr['by_plat_cd'],$key) ))); ?>
                        <?php $now_exists = ZFun::arrNormalUnique(ZFun::arrToIdsArr( array($filterArr['by_plat_cd']) )); ?>
                        <li class="<?php if(in_array($key,$now_exists)){ ?>active<?php } ?>" >
                            <?php if(in_array($key,$now_exists)){ ?>
                                <?php $now_clean_arr = Mainfunc::arrRmByVal($now_exists,$key); ?>
                                <?php $now_clean_str = implode(',',$now_clean_arr); ?>
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_plat_cd='.$now_clean_str); ?>"><{$value}></a>
                            <?php }else{ ?>
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_plat_cd='.$now_str); ?>"><{$value}></a>
                            <?php } ?>
                        </li>
                        </foreach>
                    </ul>
                </div>
            </div>
            <input type="hidden" name="by_plat_cd" value="<?php echo $filterArr['by_plat_cd']; ?>" >

            <div class="row clearfix" style="display:none;">
                <div class="col-lg-10 col-md-12 col-xs-12 menu-state ">
                    <span class="menu-state_span show_title"><{$Think.lang.所属店铺}>：</span>
                    <ul class="menu-state_ul">
                        <li class="<?php if(empty($filterArr['by_store'])){ ?>active<?php } ?>" style="display:;">
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_store='); ?>"><{$Think.lang.全部}></a>
                        </li>
                        <foreach name="store_list" key="key" item="value">
                        <?php $now_str = implode(',',ZFun::arrNormalUnique(ZFun::arrToIdsArr( array($filterArr['by_store'],$value['ID']) ))); ?>
                        <?php $now_exists = ZFun::arrNormalUnique(ZFun::arrToIdsArr( array($filterArr['by_store']) )); ?>
                        <li class="show_li <?php if(in_array($value['ID'],$now_exists)){ ?>active<?php } ?>" style="display:none;">
                            <?php if(in_array($value['ID'],$now_exists)){ ?>
                                <?php $now_clean_arr = Mainfunc::arrRmByVal($now_exists,$value['ID']); ?>
                                <?php $now_clean_str = implode(',',$now_clean_arr); ?>
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_store='.$now_clean_str); ?>"><{$value.STORE_NAME}></a>
                            <?php }else{ ?>
                            <a href="<?php echo ZFun::addQueryStrParam($form_base_url,'by_store='.$now_str); ?>"><{$value.STORE_NAME}></a>
                            <?php } ?>
                        </li>
                        </foreach>
                        <li class="openli"><{$Think.lang.展开}>>></li>
                    </ul>
                </div>
            </div>
            <input type="hidden" name="by_store" value="<?php echo $filterArr['by_store']; ?>" >

            <div class="row col-search clearfix" id="" style="position:relative;z-index:9999">
                <span class="select-box inline">
                    <select name="keyword_type" class="select">
                        <option value="1" <if condition="$filterArr.keyword_type eq 1">selected="selected"</if> ><{$Think.lang.电子邮箱}></option>
                        <option value="2" <if condition="$filterArr.keyword_type eq 2">selected="selected"</if> ><{$Think.lang.手机号码}></option>
                    </select>
                </span>
                <input type="text" name="keywords" value="<{$filterArr.keywords}>"  placeholder="<{$Think.lang.搜索关键字}>" style="width:200px;margin:0px 100px 0px 16px;padding-left:8px;" class="input-text">
            </div>

            <div class="row col-search clearfix" id="" style="margin-top:0;float:none;">
                <span class="reg-time"> <span><{$Think.lang.注册时间}>：</span>
                  <input type="text" onfocus="WdatePicker({lang:'<{:LANG_SET}>',dateFmt:'yyyy-MM-dd',maxDate:'#F{$dp.$D(\'reglogmax\')||\'%y-%M-%d\'}'})" id="reglogmin"  name="regstarttime" value="<{$filterArr.regstarttime}>" class="input-text Wdate" >
                  -
                  <input type="text" onfocus="WdatePicker({lang:'<{:LANG_SET}>',dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'reglogmin\')}',maxDate:'%y-%M-%d'})" id="reglogmax"  name="regendtime" value="<{$filterArr.regendtime}>" class="input-text Wdate" >
                </span>
                <span class="latest-login-time"><span><{$Think.lang.最新登录时间}>：</span>
                  <input type="text" onfocus="WdatePicker({lang:'<{:LANG_SET}>',dateFmt:'yyyy-MM-dd',maxDate:'#F{$dp.$D(\'loginlogmax\')||\'%y-%M-%d\'}'})" id="loginlogmin"  name="loginstarttime" value="<{$filterArr.loginstarttime}>" class="input-text Wdate" >
                  -
                  <input type="text" onfocus="WdatePicker({lang:'<{:LANG_SET}>',dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'loginlogmin\')}',maxDate:'%y-%M-%d'})" id="loginlogmax"  name="loginendtime" value="<{$filterArr.loginendtime}>" class="input-text Wdate" >
                </span>
                
            </div>
            <div class="btns">
                <button name="" class="btn btn-pink" type="submit">&nbsp;&nbsp;<{$Think.lang.查询}>&nbsp;&nbsp;</button>
                <button name="reset" class="btn btn-clear">&nbsp;&nbsp;<{$Think.lang.重置}>&nbsp;&nbsp;</button>
            </div>



            </form>
        </div>
        <div class="line"></div>
        <div class="row pos-r mr-20 ml-20" style="height:10px;">
            <div>
                <div class="col-md-5 search-num-wrap">
                    <span class="search-num"><{$Think.lang.搜索结果}>：&nbsp;&nbsp;<{$Think.lang.共}></span>
                    <span class="search-num-t" style="font-weight: 600"><{$count}></span>
                    <span class="search-num"><{$Think.lang.条记录}>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                </div>
                <!-- <ul class="pagination" style="margin:0px auto;">
                    <{$pages}>
                </ul> -->
            </div>
        </div>
        <div class="row pos-r mr-20 ml-20">
            <table class="table table-border table-bordered table-bg table-hover table-sort" >
                <thead>
                <tr class="text-c no-wrap">
                    <th><{$Think.lang.用户ID}></th>
                    <th><{$Think.lang.所属平台}></th>
                    <th><{$Think.lang.用户状态}></th>
                    <th><{$Think.lang.用户邮箱}></th>
                    <th><{$Think.lang.邮箱审核状态}></th>
                    <th><{$Think.lang.用户手机}></th>
                    <th><{$Think.lang.手机审核状态}></th>
                    <th><{$Think.lang.登录类型}></th>
                    <th><{$Think.lang.第三方扩展ID}></th>
                    <th><{$Think.lang.注册时间}></th>
                    <th><{$Think.lang.最新登录时间}></th>
                    <th><{$Think.lang.操作}></th>
                </tr>
                </thead>
                <tbody>

<if condition="empty($list) eq 1">
                <tr class="text-c va-m "  >
                    <td class="no-wrap" colspan="19"><{$Think.lang.None}></td>
                </tr>
<else />
<foreach name="list" key="key" item="value">
                <tr class="text-c va-m "  >
                    <td class="no-wrap"><{$value.CUST_ID}></td>
                    <td class="no-wrap"><?php echo D('ZZmscmncd')->getNameFromCode($value['parent_plat_cd']); ?></td>
                    <td class="no-wrap"><?php echo L(D('ZZmscmncd')->getNameFromCode($value['CUST_STAT_CD'])); ?></td>
                    <td class="no-wrap"><{$value.CUST_EML}></td>
                    <td class="no-wrap"><?php echo L(D('ZZmsthrdcust')->getStatusForCertified($value['AUTH_EMAIL'])); ?></td>
                    <td class="no-wrap"><?= CrypMobile::transformation($value['CUST_CP_NO']);  ?></td>
                    <td class="no-wrap"><?php echo L(D('ZZmsthrdcust')->getStatusForCertified($value['AUTH_MOBILE'])); ?></td>
                    <td class="no-wrap"><{$value.LOGIN_TYPE}></td>
                    <td class="no-wrap"><{$value.THIRD_UID}></td>
                    <td class="no-wrap"><{$value.JOIN_REQ_DT}></td>
                    <td class="no-wrap"><{$value.SYS_REG_DTTM}></td>
                    <td class="no-wrap">
                        <a class="link_blue" onclick="opennewtab(this,'<{$Think.lang.编辑}><?php echo $value["CUST_ID"];?>')" _href="<{:U("customer/editnewkehu",array('cust_id'=>$value['CUST_ID']))}>" ><{$Think.lang.查看}></a>
                    </td>
                </tr>
</foreach>
</if>

                </tbody>
            </table>

        </div>
        <div class="row pos-r mr-20 ml-20">
            <div>
                <div class="col-md-5 search-num-wrap">
                    <{$show_perpage_block}>
                </div>
                <ul class="pagination">
                    <{$pages}>
                </ul>
            </div>
        </div>
        <div class="row pos-r mr-20 ml-20" style="margin:40px auto;">
            &nbsp;
        </div>
    </div>


<script type="text/javascript" src="../Public/lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="../Public/lib/My97DatePicker/WdatePicker.js?v=<{$Think.const.V}>"></script>
<script type="text/javascript" src="../Public/lib/layer/1.9.3/layer.js?v=<{$Think.const.V}>"></script>
<script type="text/javascript" src="../Public/lib/laypage/1.2/laypage.js?v=<{$Think.const.V}>"></script>
<script type="text/javascript" src="../Public/js/H-ui.js"></script>
<script type="text/javascript" src="../Public/js/H-ui.admin.js?v=<{$Think.config.VER_NUM}>"></script>
<script type="text/javascript" src="../Public/js/jquery-ui.min.js?v=<{$Think.const.V}>"></script>
<script>
    $(document).ready(function (){

        //form reset
        $("button[name='reset']").click(function(){
            $("#form_search input").each(function(){
                var is_reset = true;
                var n = $(this).attr('name');
                if(n=='m' || n=='a'){
                    is_reset = false;
                }
                if(n=='by_stat_cd' || n=='by_plat_cd' || n=='by_store'){
                    is_reset = false;
                }
                if(is_reset){
                    $(this).val(null);
                }
            });

            return false;
        });

        $('.openli').click(function(){
            if($(this).text()=='<{$Think.lang.展开}>>>'){
                $(this).siblings(".show_li").show();
                $(this).text('<{$Think.lang.收起}><<');
            }else{
                $(this).siblings(".show_li").hide();
                $(this).text('<{$Think.lang.展开}>>>');
            }
        });
        $('.btn-clear').on('click',function (){
            window.location.href="/index.php?m=customer&a=kehulist"
        })

    });

</script>

</body>
</html>
